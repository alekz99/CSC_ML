# Иерархический кластерный анализ

* Кластерный анализ разделяет объекты на группы
	+ объекты внутри группы похожи между собой
	+ объекты из разных групп различаются
* Определение количества групп — часть задачи
* Группы, на которые разбита выборка, называются кластерами

### Методы кластеризации

* **Метод к-средних**
* Самоорганизующиеся карты Кохонена (SOM) – *перестали быть популярными*
* Смесь (нормальных) распределений – *сильная математика, но предполагается что в данных нормальное распределение*
* Методы, использующие непараметрические оценки плотности – *довольно нестабильны*
* **DBSCAN и OPTICS**
* **Иерархический кластерный анализ**
* Разрезание минимального остовного дерева (Minimum spanning tree) – *интереснее для математика, чем для прикладника*

### Использование кластерного анализа

+ Сегментация
+ Сокращение размерности (вместо объектов кластера берется их типичный представитель)
+ Выбросы

### Примеры

* Определение групп потребителей
	+ По данным о покупателях (результаты опроса, поведение на сайте)
	+ выявить и описать/понять рыночные сегменты
	+ выбрать сегменты, которые компания хочет обслуживать.
* Сегментация
	+ Страховая компания разделяет потенциальных клиентов на группы
	+ По результатам кластеризации для разных сегментов определяются оптимальные цены на услуги, оптимальные тарифы
	+ Но ближайшая цель — индивидуальные тарифы («Вы не принимаете лекарства»)
* Потребительские сегменты
	+ Покупателей можно группировать по разным наборам характеристик, например по возрасту, образованию, месту жительства, типу личности, и так далее.
	+ Недостаточно разделить покупателей на сегменты по **одной** (или по каждой) характеристике.
	+ Кластерный анализ разбивает потребителей на «группы со схожими потребностями в отношении конкретного товара или услуги, достаточными ресурсами, а также готовностью и возможностью покупать» учитывая все информативные показатели **одновременно**.
* Товарные группы для рекомендательной системы
	+ На рынке присутствует большой выбор товаров схожего назначения под разными торговыми марками. Надо разбить товары на группы.
	+ Иногда такое разбиение известно. Например, компьютеры бывают «для дома», «для офиса», «серверы» и «специализированные».
	+ Кластерный анализ применяется, если нет классификации, признанной всеми.
	+ Результат будет зависеть от выбранных показателей.

### Идея иерархического кластерного анализа

сведение задачи к геометрической.

* Каждый объект – точка в $R^k$.
* Похожие объекты расположены «близко» друг к другу
* Различающиеся объекты расположены «далеко»
* Скопления точек – кластер.

Расстояние между объектами:
* Евклидово расстояние
* Квадрат Евклидова расстояния
* Блок (Манхеттен, сити-блок)
* и так далее…

*Евклидово расстояние*

Две точки $(x_1, x_2, x_3), (y_1, y_2, y_3)$
$$d_{xy} = \sqrt{(x_1 - y_1)^2 + (x_2 - y_2)^2 + (x_3 - y_3)^2}$$

Квадрат евклидова расстояния не является расстоянием.

*Расстояние  Block (Manhatten, таксиста).*

$$d_{xy} = |x_1 - y_1| + |x_2 - y_2| + |x_3 - y_3|$$

![Расстояние  Block](/images/lect_2/manhaten.png)

*Расстояние Хэмминга*

* Два слова одинаковой длины
* Расстояние - число позиций, в которых соответствующие символы различны
 
* $D(1011101, 1001001) = 2$
* $D(2173896, 2233796) = 3$
* $D(\text{toned}, \text{roses}) = 3$

*Расстояние Sørensen–Dice*

$$Q = \frac{2 \cdot |A \cap B|}{|A| + |B|}$$

**Никакие усилия на подбор расстояния не являются лишними! Лучше потратить время для поиска расстояния, которое будет лучше измерять схожесть в задаче.**