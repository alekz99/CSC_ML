# Описательные статистики

**Модель** – абстрактное представление реальности в какой-либо форме (например, в математической, физической, символической, графической или дескриптивной), предназначенное для представления определённых аспектов этой реальности и позволяющее получить ответы на изучаемые вопросы.

$Y$ – теоретическое значение, $\hat{Y}$ – экспериментальное значение

Критерий качества измеряет соответствие теоретического и экспериментального значения. 
Пример критерия качества – среднее абсолютное отклонение (**Mean absolute deviation, MAD**). 
$$e_i = y_i - \hat{y_i},$$ $$MAD =\frac{1}{n} \sum_{i=1}^{n}{|e_i|}$$

### Гистограмма

##### Данные для построения
$x_1, x_2, x_3, ..., x_n$ – данные

$x_{(1)} \leq x_{(2)} \leq x_{(3)} \leq ... \leq x_{(n)}$ – вариационный ряд (расположили числа в порядке возрастания)

$a \leq x_{(1)} \leq x_{(2)} \leq x_{(3)} \leq ... \leq x_{(n)} \leq b$ – добавили минимум и максимум

##### Интервалы
* Разбиваем интервал $[a,b]$ на $k$ непересекающихся интервалов.
* интервалы обозначаем $\Delta_{i}$, где $i = 1, 2, 3, ..., k$.

##### Столбцы
Считаем, сколько наблюдений попало в каждый интервал (в интервал $\Delta_{i}$ попало $n_i$ наблюдений). Тогда сумма наблюдений во всех интервалах равна $n$: $$\sum_{i=1}^k{n_i} = n.$$

##### Высота столбца
"Наивная" формула $$h_i = c * n_i$$
"Научная" формула $$h_i = \frac{n_i}{n \cdot |\Delta_{i}|},$$ где $\Delta_{i}$ – длина интервала.

_Научная лучше тем, что в ней есть нормировка, которая делает графики сопоставимыми (+ для приближения плотности)._

![Анализ гистограммы –  сравнение площадей](/images/lect_1/histograms.png)

#### Выбор интервалов определяет вид гистограммы
* Обычно одинаковой длины.
* Лучше разной длины, но не умеем (для небольшого кол-ва наблюдений пошире и наоборот)
* Как выбирать интервалы и их число – открытый вопрос...

####  Вид гистограммы зависит от выбора начальной и конечной точек a и b


### Математика
* Плотность распределения позволяет сосчитать вероятность $$P\left\lbrace X \in [a, b)\right\rbrace = \int_{a}^{b}{f(t) \text{d}t}$$
* Обычно плотность неизвестна
* Имеются «только» данные

Гистограмма является приближением к плотности распределения наблюдаемой величины, т.е. является её оценкой. Одновременно сама гистограмма является плотностью  распределения.

####  Т.1 Гистограмма – оценка плотности
* Обозначим оцениваемую плотность распределения $f(t)$;
* Обозначим гистограмму $f_n(t)$;
* Пусть число интервалов $k$ зависит от числа наблюдений $n$: $$k = k_n.$$
* Обозначим $$|\Delta| = \max_{i = 1, 2, ..., k_n} |\Delta_i|.$$

Пусть
$$\lim_{n \rightarrow \infty}|\Delta| = 0,$$ $$\lim_{n \rightarrow \infty}k_n = \infty,$$ $$\lim_{n \rightarrow \infty}\frac{k_n}{n} = 0.$$

Тогда гистограмма по вероятности сходится к плотности распределения:
$$f_n(t) \xrightarrow[n \rightarrow \infty]{P} f(t).$$

Таким образом, вероятность того, что отклонение истинной плотности от гистограммы превысит порог $\epsilon$, стремится к нулю.

####  Т.2 Плотность распределения по вероятности будет пересекать высоту гистограммы

Пусть $\Delta_i$ – произвольный, но фиксированный отрезок
$$h_i \cdot |\Delta_i| = \frac{n_i}{n \cdot |\Delta_i|} \cdot |\Delta_i| = \frac{n_i}{n}.$$

По ЗБЧ (другими словами, чем больше объём выборки / чем чаще проводятся измерения какого-либо параметра, тем выше вероятность, что результаты окажутся близки к ожидаемым): 
$$\frac{n_i}{n} \xrightarrow[n \rightarrow \infty]{P} P\left\lbrace X \in \Delta_i\right\rbrace = \int_{\hat{a}}^{\hat{b}}{f(t) \text{d}t}.$$

По теореме о среднем 
$$\int_{\hat{a}}^{\hat{b}}{f(t) \text{d}t} = |\Delta_i| \cdot f(c),$$ где $c$ – принадлежит отрезку $[a, b)$.

Тогда 
$$h_i \xrightarrow[n \rightarrow \infty]{P} f(c).$$

![Плотность распределения по вероятности будет пересекать высоту гистограммы](/images/lect_1/theor2.png)

#### Достоинства и недостатки гистограммы

Достоинства:
* дает наглядное представление о распределении;
* выбросы, мультимодальность;
* позволяет сравнивать распределения;
* просто вычисляется;
* является оценкой плотности.

Недостатки:
* выбор границ a и b произволен;
* выбор числа интервалов k  произволен;
* не непрерывна;
* равна нулю вне интервала [a, b];
* неудобно на одном графике строить несколько гистограмм.

#### Выбор ширины интервала
* Формула Sturges’a:
$$h = R / k,$$ где $R$ – размах выборки, $k = 1 + \log_{2}{n}$.

* Формула Scott’a:
$$h = 3,5 \cdot \frac{s}{n^{1/3}},$$ где s – выборочное стандартное отклонение.

* Формула Freedman и Diaconis:
$$h = \frac{2 \cdot IQ}{n^{1/3}},$$ где $IQ$ – межквартильный размах.

Если размер выборки меньше 200 наблюдений, все формулы дают близкие результаты.

Если больше 200 наблюдений, то формула Sturges’a занижает число интервалов.

Формула Freedman и Diaconis’а устойчивее к выбросам.

**На большом наборе данных рекомендуется использовать формулу Freedman и Diaconis (по умолчания в библиотеках используется формула Sturges’a).**
